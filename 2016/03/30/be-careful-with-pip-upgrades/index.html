<!DOCTYPE html>
<!--[if IE 8 ]><html class="ie ie8" lang="en"> <![endif]-->
<!--[if (gte IE 9)|!(IE)]><!-->
<html lang="en">
<!--<![endif]-->
	<head>
            <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
        <meta name="author" content="Guilherme Toti">


        <title>Guilherme Toti - Be careful with PIP upgrades!</title>

            <link href="http://www.guilhermetoti.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Guilherme Toti Full Atom Feed" />
            <link href="http://www.guilhermetoti.com/feeds/python.atom.xml" type="application/atom+xml" rel="alternate" title="Guilherme Toti Categories Atom Feed" />

        <!-- CSS -->
        <link rel="stylesheet" href="http://www.guilhermetoti.com/theme/css/style.css">

        <!-- Custom CSS -->
        	<link rel="stylesheet" href="http://www.guilhermetoti.com/theme/css/colors/blue.css" id="colors">

        <!-- Code highlight color scheme -->
            <link href="http://www.guilhermetoti.com/theme/css/code_blocks/darkly.css" rel="stylesheet">


        <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
        <![endif]-->




        <meta name="tags" contents="python" />
        <meta name="tags" contents="pip" />
        <meta name="tags" contents="upgrades" />

	                <meta property="og:locale" content="en_US">
		<meta property="og:site_name" content="Guilherme Toti">

	<meta property="og:type" content="article">
	<meta property="article:author" content="">
	<meta property="og:url" content="http://www.guilhermetoti.com/2016/03/30/be-careful-with-pip-upgrades/">
	<meta property="og:title" content="Be careful with PIP upgrades!">
	<meta property="og:description" content="">
	   <meta property="og:image" content="http://www.guilhermetoti.com/images/guilherme-toti.jpg">
	<meta property="article:published_time" content="2016-03-30 23:59:00-03:00">
	</head>
	<body>
		<header id="header">
			<!-- Container -->
			<div class="container">
				<!-- Logo / Mobile Menu -->
				<div class="three columns">
					<div id="logo">
						<h1><a href="http://www.guilhermetoti.com/">Guilherme Toti</a></h1>
					</div>
				</div>
				<!-- Navigation
				================================================== -->
				<div class="thirteen columns">
					
					<nav id="navigation" class="menu">
						<ul id="responsive">

							<li><a href="http://www.guilhermetoti.com/">Home</a></li>


							        <li><a href="http://www.guilhermetoti.com/pages/about.html">About</a></li>
						</ul>
					</nav>
				</div>
			</div>
			<!-- Container / End -->
		</header>
		<!-- Header / End -->
		
		<div id="content-wrapper">
			<section id="titlebar">
				<!-- Container -->
				<div class="container">
					<div class="sixteen columns">						
						<nav id="breadcrumbs">
							<ul>
								<li>You are here:</li>
								<li><a href="http://www.guilhermetoti.com/">Home</a></li>
<li><a href="http://www.guilhermetoti.com/category/python">python</a></li>
<li>Be careful with PIP upgrades!</li>
							</ul>
						</nav>
					</div>

				</div>
				<!-- Container / End -->
			</section>

			<div class="container">
	<div class="twelve alt columns">
<article class="post" style="margin: 0; border: 0;">

	<div class="post-format">
		<div class="circle"><i class="icon-pencil"></i><span></span></div>
	</div>

	<section class="post-content">

		<header class="meta">
			<h2><a href="http://www.guilhermetoti.com/2016/03/30/be-careful-with-pip-upgrades/">Be careful with PIP upgrades!</a></h2>
			<ul>
				<li>By <a href="http://www.guilhermetoti.com/author/guilherme-toti.html">Guilherme Toti</a></li>
				<li>Wed 30 March 2016</li>
			</ul>
		</header>

		<p>Hey guys! How are you going?
It have been a long time since my last post, I was working a lot and I had no time to read more, sorry...</p>
<p>On this post I will talk about an experience that my friend and I lived upgrading PIP packages.</p>
<h4>The situation</h4>
<p>The Magazine Luiza's website was writted with Bottle, and is a bit old, so, as you can imagine, the PIP package's versions are old too.
We use Jinja2 to render templates, and, we wanted to upgrade some packages just to feel more confortable.
Well, we saw on <code>requirements</code> that Jinja2 was on version <code>2.5.5</code> and the last version was <code>2.8</code>, so, we just changed the <code>2.5.5</code> to <code>2.8</code> and installed the requirements again. <em>Easy, huh?</em></p>
<p>But we didn't expect that this would broke almost everything! But, why?</p>
<h4>The error</h4>
<p>At some templates files, Jinja was throwing the error: <code>non-default argument follows default argument</code>, but, wtf? We just upgraded to the new version! What's wrong? What have changed?</p>
<p>We are almost getting crazy when we decided to search on Google, and, we saw this on <a href="http://jinja.pocoo.org/docs/dev/changelog/#version-2-8">Jinja2's Version 2.8 Changelog</a>:</p>
<div class="highlight"><pre><span></span>* Added a check for default arguments followed by non-default arguments. This change makes {% macro m(x, y=1, z) %}...{% endmacro %} a syntax error. The previous behavior for this code was broken anyway (resulting in the default value being applied to y).
</pre></div>


<h4>Okay, but, what's wrong?</h4>
<p>You must be thinking: <code>My gosh, this is stupid, everyone knows the default arguments are always first!</code>.</p>
<p>Yeah, but, like I said, the code is old, and Jinja didn't had this check before, and we have found a lot of <code>macros</code> like that:</p>
<div class="highlight"><pre><span></span>{% macro test(a, b, c=None, d) -%}
    bla bla bla
{%- endmacro  %}
</pre></div>


<p>So, we had to refactor every piece of code that have this error... <sad></p>
<h4>What to learn with that?</h4>
<p>Be careful when upgrading PIP packages, test everything after that, i said EVERYTHING.</p>
<p>And, when you install some package, try to put the version in the <code>requirements</code> file, like:</p>
<div class="highlight"><pre><span></span>Jinja2==2.8
</pre></div>


<p>If you just put <code>Jinja2</code> you will always get the last version, but, a simple upgrade can broke your project.</p>
<blockquote>
<p>Tip of the day: A no noticeable error can f*ck everything!</p>
</blockquote>
<p>That's all, cya!</p>

		    <div class="tags">
		        <p>tags: <a href="http://www.guilhermetoti.com/tag/python.html">python</a><a href="http://www.guilhermetoti.com/tag/pip.html">pip</a><a href="http://www.guilhermetoti.com/tag/upgrades.html">upgrades</a></p>
		    </div>

<div class="sharing">
        <!-- AddThis Button BEGIN -->
        <div class="addthis_toolbox addthis_default_style addthis_32x32_style">
            <a class="addthis_button_preferred_1"></a>
            <a class="addthis_button_preferred_2"></a>
            <a class="addthis_button_preferred_3"></a>
            <a class="addthis_button_preferred_4"></a>
            <a class="addthis_button_preferred_5"></a>
            <a class="addthis_button_preferred_6"></a>
            <a class="addthis_button_preferred_7"></a>
            <a class="addthis_button_preferred_8"></a>
            <a class="addthis_button_preferred_9"></a>
            <a class="addthis_button_compact"></a>
            <a class="addthis_counter addthis_bubble_style"></a>
        </div>
        <script type="text/javascript" src="http://s7.addthis.com/js/300/addthis_widget.js#pubid=ra-56c64315810bc72f"></script>
        <!-- AddThis Button END -->
</div>
<hr>

		    <div class="comments">
		        <div id="disqus_thread"></div>
		        <script type="text/javascript">
		            var disqus_shortname = 'guilhermetoti';
		            var disqus_identifier = '2016/03/30/be-careful-with-pip-upgrades/';
		            var disqus_url = 'http://www.guilhermetoti.com/2016/03/30/be-careful-with-pip-upgrades/';
		            (function() {
		                var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
		                dsq.src = '//guilhermetoti.disqus.com/embed.js';
		                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
		            })();
		        </script>
		        <noscript>Please enable JavaScript to view the comments.</noscript>
		    </div>
	</section>
	<div class="clearfix"></div>

</article>

	</div>

	<!-- Sidebar -->
	<div class="four columns">
		<!-- About  -->
		<div class="widget no-mg-top">
			<h3 class="headline">About</h3><span class="line"></span><div class="clearfix"></div>
			<p>Brazilian Software Engineer, 23 years old, radical sports lover and addicted in knowledge. This is me.</p>
		</div>

		<!-- Categories -->
		<div class="widget">
			<h3 class="headline">Categories</h3><span class="line"></span><div class="clearfix"></div>
			<nav class="categories">
				<ul>
					    <li class="active"><a href="http://www.guilhermetoti.com/category/python.html">python</a></li>
				</ul>
			</nav>
		</div>
		
		<!-- Tags -->
		<div class="widget">
			<h3 class="headline">Tags</h3><span class="line"></span><div class="clearfix"></div>
			<nav class="tags">				    <a href="http://www.guilhermetoti.com/tag/github.html">github</a>
				    <a href="http://www.guilhermetoti.com/tag/pelican.html">pelican</a>
				    <a href="http://www.guilhermetoti.com/tag/pip.html">pip</a>
				    <a href="http://www.guilhermetoti.com/tag/python.html">python</a>
				    <a href="http://www.guilhermetoti.com/tag/upgrades.html">upgrades</a>
			</nav>
		</div>
	</div>
			</div>
			<!-- Container / End -->
		</div>
		<!-- Content Wrapper / End -->


		<div id="footer-bottom">
			<!-- Container -->
			<div class="container">
				<div class="eight columns">Blog powered by <a href="http://getpelican.com">Pelican</a></div>
					<div class="eight columns">
						<ul class="social-icons-footer">
								<li>
									<a href="https://github.com/guilherme-toti" class="tooltip top" title="github">
										<i class="icon-github"></i>
									</a>
								</li>
								<li>
									<a href="http://www.facebook.com/GuiMToti" class="tooltip top" title="facebook">
										<i class="icon-facebook"></i>
									</a>
								</li>
							<li><a href="http://www.guilhermetoti.com/feeds/all.atom.xml" class="tooltip top" title="RSS"><i class="icon-rss"></i></a></li>
						</ul>
					</div>
			</div>
			<!-- Container / End -->
		</div>
		<!-- Footer Bottom / End -->
		
	<!-- Javascripts -->
	<script src="http://www.guilhermetoti.com/theme/js/jquery.min.js"></script>
    <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-39972528-7']);
    _gaq.push(['_trackPageview']);
    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
    </script>
<script type="text/javascript">
    var disqus_shortname = 'guilhermetoti';
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
	</body>
</html>